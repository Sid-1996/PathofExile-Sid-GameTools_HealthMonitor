# 🚀 發布說明

## 版本 v1.0.5 - 一鍵清包系統重大優化版 (2025-09-25)

### 🎯 核心功能優化

#### 🧹 一鍵清包系統全面升級

- **動態辨識機制**: 徹底重構清包邏輯，每次點擊後重新掃描背包狀態，完全適應大物品占多格的情況
- **智能倉庫滿載檢測**: 新增先進的物品數量變化追蹤，自動檢測倉庫空間不足，避免無限循環
- **精準點擊控制**: 優化滑鼠操作時序，確保每次點擊的精確性和可靠性
- **實時狀態更新**: 提升UI響應速度，實時顯示清包進度和背包狀態變化

### 📊 技術改進

- **演算法優化**: 從靜態分組處理升級為動態循環處理，大幅提升清包成功率
- **錯誤處理強化**: 新增多層防護機制，防止各種異常情況下的系統卡死
- **性能提升**: 減少不必要的螢幕截圖和圖像處理，提升整體運行效率

### 🛡️ 穩定性提升

- **防無限循環**: 多重保護機制確保系統在任何情況下都能正常停止
- **異常恢復**: 增強錯誤處理能力，提升系統的健壯性
- **用戶體驗**: 清晰的狀態提示，讓用戶了解當前操作狀態

### 🎨 用戶介面優化

#### 🖥️ 區域選擇體驗提升

- **智能視窗管理**: 選擇血量和魔力區域時，主GUI自動最小化，提供清晰的遊戲視窗視野
- **精確區域框選**: 最小化後的半透明選擇介面讓用戶能夠精確框選目標區域
- **自動視窗恢復**: 選擇完成或取消後，主GUI自動恢復顯示，操作流程更加流暢

#### 🎯 F6取物功能座標系統優化

- **相對座標系統**: 徹底重構F6取物座標處理，從絕對螢幕座標改為相對於遊戲視窗的座標
- **視窗位置免疫**: 解決遊戲視窗移動後取物功能失效的關鍵問題，實現真正的位置無關性
- **動態座標轉換**: 設定時記錄相對座標，執行時動態轉換為絕對座標，與F3清包系統保持一致
- **向後相容性**: 智能處理舊的絕對座標配置，確保平滑升級體驗

---

## 版本 v1.0.4 - 多語言支援完善版 (2025-09-23)

### 🌍 新增功能

#### 🗣️ 完整多語言支援系統

- **全面狀態消息本地化**: 實現所有"執行狀態"分頁消息的完整語言切換支援
- **F3/F6操作本地化**: 一鍵清包和自動撿取功能的所有狀態消息支援中英文切換
- **技能連段系統本地化**: 技能連段執行狀態消息完全支援語言切換，包括攻擊類型和發送方法
- **統一翻譯架構**: 新增攻擊類型("原地攻擊"/"普通攻擊")和發送方法("選擇性發送"/"全局發送")的翻譯鍵

#### 🌐 語言切換系統

- **語言切換**: 支援中文和英文之間的切換，設定會自動保存，應用程式會關閉並需要手動重啟以應用新語言
- **持久化語言設定**: 語言偏好設定會自動保存到設定檔案中
- **雙語提示訊息**: 重要操作提示同時顯示中英文，確保用戶理解
- **重啟提示優化**: EXE版本在語言切換後顯示雙語重啟提示，Python版本自動重啟

#### ⏱️ 工具使用時間計時器

- **使用時間追蹤**: 自動記錄應用程式的總使用時間
- **Windows註冊表儲存**: 使用時間數據安全儲存在Windows註冊表中，支援應用程式重啟後恢復
- **即時顯示**: 在"關於"分頁中顯示累計使用時間，支援即時更新
- **格式化顯示**: 使用時間以易讀的格式顯示（天、小時、分鐘）
- **重啟保護**: 應用程式重啟時自動保存和恢復使用時間數據

#### 🔧 系統優化

- **狀態消息系統完善**: 所有硬編碼中文字符串替換為get_text()動態調用
- **翻譯鍵擴充**: 新增"stationary_attack"、"normal_attack"、"selective_send"、"global_send"等翻譯鍵
- **代碼結構優化**: 統一所有狀態消息的本地化處理邏輯
- **註冊表操作**: 新增安全的Windows註冊表讀寫功能
- **時間處理**: 新增精確的時間追蹤和格式化功能

### 📝 詳細更新內容

#### 🌐 語言切換功能完善

- **F3清包功能**: 所有清包操作狀態消息支援語言切換
- **F6撿取功能**: 所有自動撿取狀態消息支援語言切換
- **技能連段功能**: 所有連段執行狀態消息支援語言切換，包括：
  - 技能編號和名稱顯示
  - 攻擊類型指示(原地攻擊/普通攻擊)
  - 發送方法指示(選擇性發送/全局發送)

#### � 語言切換系統詳情

- **設定介面整合**: 在設定分頁中提供語言選擇下拉選單
- **語言切換**: 選擇新語言後設定會自動保存，應用程式會關閉並需要手動重啟以應用新語言設定
- **設定持久化**: 語言偏好自動保存到設定檔案，重啟後保持選擇
- **雙語提示**: 重要操作（如語言切換後的重啟提示）同時顯示中英文
- **應用程式適配**: EXE版本顯示重啟提示，Python版本自動重啟

#### ⏱️ 使用時間計時器詳情

- **自動啟動**: 應用程式啟動時自動開始計時
- **持續追蹤**: 無論應用程式是否在前台運行，都持續累計使用時間
- **安全儲存**: 使用Windows註冊表存儲時間數據，支援系統重啟後恢復
- **即時顯示**: 在"關於"分頁中顯示格式化的使用時間（天:小時:分鐘）
- **重啟保護**: 應用程式重啟或語言切換時自動保存當前使用時間

#### �🎯 用戶體驗提升

- **無縫語言切換**: 無論在中文或英文模式下，所有狀態消息都能正確顯示對應語言
- **一致性保證**: 確保所有功能模組的狀態消息都遵循統一的本地化標準
- **時間追蹤透明**: 用戶可以清楚了解工具的使用情況
- **設定記憶**: 語言偏好和使用時間數據都能正確保存和恢復

---

## 版本 v1.0.3 -#### � 用戶體驗提升

- **視窗操作流暢**: 改善了分頁視窗的開啟、關閉和切換體驗
- **狀態顯示完善**: 確保所有分頁的狀態指示器都能正確顯示
- **操作反饋優化**: 增強了用戶操作的視覺和文**v1.0.3** (2025-09-21)

- 🎨 全面優化所有分頁的視窗佈局和元件排版
- ✨ 統一各分頁的字體、顏色和間距設計
- 🔧 完善獨立分頁視窗系統的UI元件管理
- � 改善分頁切換和視窗操作的用戶體驗
- �️ 增強分頁視窗的錯誤處理和資源管理
- 🐛 **修復庫存預覽偏移顯示問題**: 修正預覽渲染中的偏移計算邏輯
- 🔄 **統一選擇功能的 GUI 處理**: 標準化所有選擇功能的視窗管理行為
- ⌨️ **統一 ESC 鍵處理跨選擇功能**: 增強 ESC 鍵取消支援，適用於所有選擇模式
- 💾 **修復關閉應用程序時的儲存確認對話框行為**: 實現靜默儲存，改善應用關閉體驗

### 🐛 錯誤修復

#### 📦 功能修復

- **修復庫存預覽偏移顯示問題**: 修正 `update_inventory_preview_with_items()` 和 `update_inventory_preview_with_progress()` 中的偏移計算邏輯，確保預覽正確顯示
- **統一選擇功能的 GUI 處理**: 標準化 `select_inventory_region()`、`select_inventory_ui_region()` 和 `select_interface_ui_region()` 的 GUI 最小化、遊戲視窗激活和恢復邏輯
- **統一 ESC 鍵處理跨選擇功能**: 增強 `global_esc_handler_for_inventory()` 以支援多個選擇狀態的統一取消操作
- **修復關閉應用程序時的儲存確認對話框行為**: 修改 `save_config()` 支援 `show_message` 參數，在應用關閉時進行靜默儲存而不顯示確認訊息框版

發布日期：2025年9月21日

### 🎨 分頁美化和排版優化

#### ✨ 獨立分頁視窗系統完善

- **視窗佈局優化**: 改善**v1.0.3** (2025-09-21)

- 🎨 **全面優化所有分頁的視窗佈局和元件排版**
- ✨ **統一各分頁的字體、顏色和間距設計**
- 🔧 **完善獨立分頁視窗系統的UI元件管理**
- 📱 **改善分頁切換和視窗操作的用戶體驗**
- 🛠️ **增強分頁視窗的錯誤處理和資源管理**窗大小和佈局比例
- **元件間距調整**: 優化了按鈕、標籤和輸入框之間的間距
- **字體和顏色統一**: 統一了各分頁的字體大小和顏色方案
- **響應式設計**: 確保在不同螢幕解析度下都能正常顯示

#### 🔧 技術改進

- **UI元件管理**: 完善了獨立分頁視窗的UI元件狀態同步
- **錯誤處理強化**: 增強了分頁切換和視窗管理的錯誤處理
- **記憶體優化**: 改進了分頁視窗的資源管理和清理邏輯

#### � 用戶體驗提升

- **視窗操作流暢**: 改善了分頁視窗的開啟、關閉和切換體驗
- **狀態顯示完善**: 確保所有分頁的狀態指示器都能正確顯示
- **操作反饋優化**: 增強了用戶操作的視覺和文字反饋

---

## 版本 v1.0.2 - 按鍵系統優化版

發布日期：2025年9月21日

### ⚡ 新增功能

#### 🎯 雙重按鍵發送機制

- **血魔監控專用系統**: 使用keyboard庫+窗口激活，完全修復ESC鍵閃爍問題
- **技能連段專用系統**: 保持原始SendMessage機制，確保不干擾聊天輸入
- **200ms防重複保護**: 血魔監控增加防重複觸發機制，避免誤觸發
- **分離式架構**: 不同功能使用最適合的按鍵發送方式

#### 🔧 技術優化

- **按鍵穩定性大幅提升**: 血魔監控不再出現ESC菜單閃爍現象
- **聊天安全保障**: 技能連段執行時不會意外觸發聊天窗口
- **調試信息增強**: 清楚標示🩸血魔監控和⚔️技能連段的按鍵發送

### 🔄 改進內容

#### 🩸 血魔監控改進

- **全新按鍵發送引擎**: 使用keyboard庫替代Windows API，解決閃爍問題
- **智能窗口激活**: 發送按鍵前自動激活遊戲窗口，確保準確性
- **防重複觸發**: 200毫秒內重複觸發自動忽略，避免誤操作

#### ⚔️ 技能連段改進

- **精確窗口定位**: 維持SendMessage直接發送到遊戲窗口
- **聊天干擾消除**: 確保技能連段不會意外觸發聊天功能
- **響應速度優化**: 保持10毫秒精確延遲，確保連段準確性

---

## 版本 v1.0.1 - 修復更新版

發布日期：2025年9月19日

### 🐛 修復內容

#### 🔧 視窗管理修復

- **修復 GUI 凍結問題**: 解決坐標設定完成後主介面完全無響應的問題
- **優化視窗焦點管理**: 修正設定視窗重新激活時錯誤聚焦的邏輯
- **改善視窗層級控制**: 確保主視窗在設定完成後正確恢復焦點

#### ⌨️ 熱鍵系統修復

- **修復熱鍵失效問題**: 解決設定完成後所有熱鍵（F3、F5、F6、F9、F10、F12）無響應的問題
- **優化鍵盤監聽器清理**: 在設定過程中正確清理臨時監聽器並重新設置全局熱鍵
- **增強熱鍵穩定性**: 確保熱鍵功能在各種操作後都能正常恢復

### 📦 打包優化

#### 🏗️ 獨立執行環境

- **完整依賴打包**: 所有 Python 依賴和運行時庫已打包進單一 exe 文件
- **零依賴安裝**: 用戶無需安裝 Python 或任何第三方套件
- **輕量化部署**: 單一可執行文件，方便分發和使用

#### 📋 系統需求簡化

- **移除 Python 依賴**: 不再需要 Python 3.10+ 環境
- **簡化安裝流程**: 下載後直接運行，無需額外配置
- **跨環境相容**: 在不同 Windows 環境下都能穩定運行

### 🔄 版本差異

| 功能 | v1.0.0 | v1.0.1 | v1.0.2 | v1.0.3 | v1.0.4 | v1.0.5 |
|------|--------|--------|---------|---------|---------|---------|
| GUI 凍結修復 | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 熱鍵失效修復 | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 獨立 exe 打包 | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 零依賴安裝 | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| ESC閃爍修復 | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| 雙重按鍵機制 | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| 聊天安全保障 | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| 防重複觸發 | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| 分頁美化優化 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 排版佈局改善 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 視窗佈局優化 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 庫存預覽偏移修復 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 選擇功能 GUI 統一 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| ESC 鍵處理統一 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 儲存確認修復 | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| 完整多語言支援 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| 狀態消息本地化 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| F3/F6操作本地化 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| 技能連段本地化 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| 語言切換系統 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| 工具使用時間計時器 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| 一鍵清包動態優化 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 倉庫滿載智能檢測 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 區域選擇GUI最小化 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| F6取物座標系統優化 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 安裝複雜度 | 中等 | 極低 | 極低 | 極低 | 極低 | 極低 |

### 📋 更新日誌

**v1.0.5** (2025-09-25)

- 🧹 **一鍵清包系統重大優化**：實現動態辨識機制，完美適應大物品占多格情況
- 🛡️ **智能倉庫滿載檢測**：新增物品數量變化追蹤，自動停止避免無限循環
- ⚡ **性能與穩定性提升**：優化演算法，強化錯誤處理，提升整體系統可靠性
- 🎨 **區域選擇體驗優化**：選擇血量和魔力區域時GUI自動最小化，提供清晰視野
- 🎯 **F6取物座標系統優化**：實現相對座標系統，解決遊戲視窗移動後功能失效問題

**v1.0.4** (2025-09-23)

- 🌍 **完整多語言支援系統**：實現所有狀態消息的完整語言切換支援
- 🌐 **語言切換系統**：支援中英文切換，設定持久化保存，應用程式關閉後需要手動重啟
- ⏱️ **工具使用時間計時器**：自動追蹤並顯示應用程式使用時間
- 💾 **Windows註冊表儲存**：使用時間數據安全儲存在系統註冊表中
- 🗣️ **雙語提示訊息**：重要操作提示同時顯示中英文
- 🔄 **狀態消息本地化**：F3/F6操作和技能連段功能完全支援語言切換
- ⚙️ **設定介面整合**：語言選擇無縫整合到設定分頁中

**v1.0.3** (2025-09-21)

- 🎨 全面優化所有分頁的視窗佈局和元件排版
- ✨ 統一各分頁的字體、顏色和間距設計
- 🔧 完善獨立分頁視窗系統的UI元件管理
- � 改善分頁切換和視窗操作的用戶體驗
- �️ 增強分頁視窗的錯誤處理和資源管理

**v1.0.2** (2025-09-20)

- ⚡ **雙重按鍵發送機制**：全新分離式按鍵發送架構
- 🩸 **血魔監控優化**：使用keyboard庫+窗口激活，完全修復ESC閃爍問題
- ⚔️ **技能連段保障**：維持SendMessage精確窗口定位，確保不干擾聊天
- 🛡️ **防重複保護**：血魔監控增加200ms防重複觸發機制
- 🔍 **調試信息增強**：清楚標示🩸血魔監控和⚔️技能連段的按鍵發送
- 🚀 **穩定性提升**：按鍵發送穩定性大幅改善，用戶體驗優化

**v1.0.1** (2025-09-18)

- 🐛 **修復坐標設定後 GUI 凍結問題**
- ⌨️ **修復設定完成後熱鍵失效問題**
- 📦 **實現完整依賴打包，生成獨立 exe**
- 🏗️ **優化視窗焦點管理和鍵盤監聽器清理**
- 📋 **簡化用戶安裝流程，移除依賴需求**

**v1.0.0** (2025-09-15)

- 🎉 **正式發布**
- ✨ **魔力監控系統**：全新的魔力條檢測和監控功能
- 🖼️ **視覺預覽增強**：即時預覽監控區域和檢測結果
- ⚡ **效能最佳化**：降低CPU使用率，提升響應速度
- 📦 **完整安裝包**：提供一鍵安裝體驗
- 🔧 **功能完善**：所有核心功能完整實現

---

**免責聲明**: 此工具僅供個人學習和研究使用，請遵守遊戲官方規定。開發者不對使用此工具產生的任何後果負責.
