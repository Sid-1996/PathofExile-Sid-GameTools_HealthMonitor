# Path of Exile 遊戲輔助工具 - 運作原理（公開版抽象說明）

未公開：
- 最大並行組合數量與內部序列約束
- 延遲下限/偏移抖動策略
- 失敗重試與中途取消條件

---

## 🎯 雙重按鍵發送機制（v1.0.2新增）

為了解決不同功能場景的按鍵發送需求，系統採用分離式按鍵發送架構：

### 🩸 血魔監控專用系統
概念：使用全局按鍵發送+窗口激活機制，優化使用體驗
- 窗口激活確保按鍵發送到正確目標
- 防重複觸發機制避免誤操作
- 提升按鍵發送穩定性

### ⚔️ 技能連段專用系統  
概念：使用精確窗口定位發送，確保不干擾其他應用
- 直接發送到目標窗口，避免聊天輸入干擾
- 維持精確時序控制
- 保證連段執行準確性

抽象保護：
- 具體的按鍵發送API和實現方式不公開
- 防重複的時間閾值和算法不公開
- 窗口檢測和激活的詳細邏輯不公開

---

## 🎒 一鍵清包（抽象）架構總覽

本文件為公開版僅提供「概念層級」的原理摘要，去除了內部實作與參數細節（例如：實際採樣點數、精確時間間隔、容差計算、降載策略、錯誤復原演算法等）。

核心使用到的技術面向：

- **螢幕影像分析**：擷取指定小區域而非整個畫面，以降低資源負擔
- **顏色/像素分佈判斷**：採用穩健色彩空間進行區塊與狀態辨識
- **全域快捷鍵監聽**：集中管理啟動/停止/功能觸發
- **視窗前景檢查**：僅在遊戲視窗活躍時執行動作，避免外部干擾
- **並行任務調度**：區分輸入模擬、影像監控與 UI 邏輯

---

## 🩸 血/魔監控（抽象）

此功能會在使用者自行框選的 UI 區域內進行「有限採樣 + 多條件融合」判斷，推估目前血量/魔力量級，並與使用者設定的多層級觸發條件比較：

流程概念：
1. 取得小面積截圖（僅已設定區域）
2. 轉換至適合分離色相/飽和度的色彩空間
3. 多點或區段統計 → 產生佔比/穩定度指標
4. 與使用者設定之層級比較，判定是否執行對應補給按鍵
5. 檢查視窗焦點與冷卻節流 → 符合才觸發輸入

抽象性保護：
- 不公開實際採樣點數/權重係數/內部平滑策略
- 冷卻與節流邏輯僅以「避免連續誤觸發」描述
- 視窗與狀態檢查的具體輪詢頻率不公開

---

## ⚡ 技能連段（抽象）

概念：使用者定義「觸發鍵」與一串順序化的輸入；觸發時系統按既定延遲發送。

保留原則：
- 僅於目標視窗活躍與未暫停時運行
- 含節流/中斷判斷，避免堆疊輸出

未公開細節：
- 最大並行組合數量與內部序列約束
- 延遲下限/偏移抖動策略
- 失敗重試與中途取消條件

---

## 🎒 一鍵清包（抽象）

概念：在使用者預先建立「空背包基準」與「格子座標模型」後，對每格做簡化差異判斷 → 有差異即視為有物品 → 順序化點擊。

抽象保護：
- 未公開差異判斷公式與容差調適
- 未公開格子掃描順序優化與跳過策略
- 緊急中止條件僅概念描述，不列舉具體操作細節

---

## 🖱️ 自動連點（抽象）

概念：透過鍵/滑鼠組合進入循環；以受控頻率模擬點擊；釋放或再次觸發關閉。

未公開：精確點擊間隔、抖動策略、資源自調機制。

---

## 🔧 系統整合（抽象）

視窗/焦點層：保持只對前景目標執行；解析度/多螢幕以相對換算處理。座標轉換與前景判定之細部流程已抽象化。

任務分離：監控、輸入、UI 各自並行，錯誤隔離，避免互相阻塞。

效能理念：
- 以「需求驅動」擷取：只抓必要區域 / 事件觸發再延伸
- 動態節流：負載高時降低更新頻率
- 例外保護：局部錯誤不致停用全部功能

---

## 🛡️ 安全與穩定（公開摘要）

保護面：
- 動作執行前多條件驗證（焦點 / 狀態 / 冷卻）
- 暫停與中止邏輯彼此獨立，降低誤停可能
- 設定安全保存，單點異常不影響其餘功能

不公開：
- 內部錯誤分級標準、重試次數與退避曲線
- 緊急中止實作細節
- 動態資源回收閾值

---

## 🎮 應用場景（示例）

- 生存：專心迴避與定位，血/魔閾值自動處理
- 輸出：常用循序鍵組交給連段，手動保留反應技
- 整理：減少背包清理時間，提升地圖運行節奏
- 重複：連點釋放注意力，處理需大量互動行為

---

## 📊 抽象化參數範疇

僅提供範疇而非具體數值：
- 擷取頻率：依硬體動態調整，不固定公開值
- 採樣策略：多點/區塊融合 + 平滑
- 輸出節流：冷卻 + 條件再驗證
- 資源控制：低持續 CPU / 適中記憶體佔用
- 相容性：Windows 常見版本 + 標準解析度 + 多螢幕

---

## 💝 支持開發者

如果你對這些技術實現感興趣，歡迎支持開發者：

- 🇹🇼 [愛發電](https://afdian.com/a/sid-1996) - 台灣地區首選
- ☕ [Ko-fi](https://ko-fi.com/K3K11KMXOL) - 國際平台
- 💳 [綠界支付](https://p.ecpay.com.tw/E0E3A) - 台灣便利支付
- 🌍 [PayPal (1)](https://www.paypal.com/ncp/payment/GJS4D5VTSVWG4) - 國際支付
- 🌍 [PayPal (2)](https://www.paypal.com/ncp/payment/S5PTHJJVBC5VS) - 備用連結

感謝所有支持者！你們的支持讓更多功能得以實現 ❤️

---

**本公開版原理文件僅供理解設計理念；細節與內部演算法、精確閾值與策略已刻意抽象化。**